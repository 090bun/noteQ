(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[167],{548:t=>{t.exports={authMain:"fgtpsd_authMain__4d8Z_",authContainer:"fgtpsd_authContainer__CLI35",formSection:"fgtpsd_formSection__zjIwr",authTitle:"fgtpsd_authTitle__AhBtR",authForm:"fgtpsd_authForm__8h8Ms",inputGroup:"fgtpsd_inputGroup__eAYgE",inputHeader:"fgtpsd_inputHeader__Fo_lw",inputIcon:"fgtpsd_inputIcon__zsjBQ",icon:"fgtpsd_icon__KfnvE",inputLabel:"fgtpsd_inputLabel__BQwlq",inputField:"fgtpsd_inputField__AYD_o",inputUnderline:"fgtpsd_inputUnderline__OKoZv",passwordInputContainer:"fgtpsd_passwordInputContainer__Y9T1k",passwordToggle:"fgtpsd_passwordToggle__C5_45",hidden:"fgtpsd_hidden__vObhN",authButton:"fgtpsd_authButton__s8QU1",switchLink:"fgtpsd_switchLink__cx5L_",linkText:"fgtpsd_linkText__GDt57"}},1211:(t,e,s)=>{Promise.resolve().then(s.bind(s,6735))},4247:(t,e,s)=>{"use strict";s.r(e),s.d(e,{closeCustomConfirm:()=>n,safeConfirm:()=>a,showCustomConfirm:()=>o});let o=(t,e,s)=>{let o=document.createElement("div");o.className="custom-confirm-modal",o.innerHTML='\n        <div class="custom-confirm-content">\n            <div class="custom-confirm-message">'.concat(t,'</div>\n            <div class="custom-confirm-buttons">\n                <button class="custom-confirm-btn custom-confirm-cancel" onclick="closeCustomConfirm(false)">取消</button>\n                <button class="custom-confirm-btn custom-confirm-ok" onclick="closeCustomConfirm(true)">確定</button>\n            </div>\n        </div>\n    '),document.body.appendChild(o),window.customConfirmCallbacks={onConfirm:e,onCancel:s},document.body.style.overflow="hidden",setTimeout(()=>{o.classList.add("active")},10)},n=t=>{let e=document.querySelector(".custom-confirm-modal");e&&(e.classList.remove("active"),setTimeout(()=>{document.body.removeChild(e),document.body.style.overflow="auto",window.customConfirmCallbacks&&(t&&window.customConfirmCallbacks.onConfirm?window.customConfirmCallbacks.onConfirm():!t&&window.customConfirmCallbacks.onCancel&&window.customConfirmCallbacks.onCancel(),window.customConfirmCallbacks=null)},300))},a=(t,e,s)=>{o(t,e,s)}},4740:(t,e,s)=>{"use strict";s.r(e),s.d(e,{closePasswordChangeDialog:()=>n,confirmPasswordChange:()=>a,showPasswordChangeDialog:()=>o});let o=t=>{let e=document.createElement("div");e.className="custom-prompt-modal",e.innerHTML='\n        <div class="custom-prompt-content">\n            <div class="custom-prompt-title">更改密碼</div>\n            <div class="password-input-group">\n                <label for="oldPasswordInput">舊密碼：</label>\n                <input type="password" class="custom-prompt-input" id="oldPasswordInput" placeholder="請輸入舊密碼">\n            </div>\n            <div class="password-input-group">\n                <label for="newPasswordInput">新密碼：</label>\n                <input type="password" class="custom-prompt-input" id="newPasswordInput" placeholder="請輸入新密碼">\n            </div>\n            <div class="custom-prompt-buttons">\n                <button class="custom-prompt-btn custom-prompt-btn-secondary" onclick="closePasswordChangeDialog()">取消</button>\n                <button class="custom-prompt-btn custom-prompt-btn-primary" onclick="confirmPasswordChange()">確定</button>\n            </div>\n        </div>\n    ',document.body.appendChild(e),window.passwordChangeCallback=t,document.body.style.overflow="hidden",setTimeout(()=>{e.classList.add("active");let t=document.getElementById("oldPasswordInput");t&&t.focus()},10)},n=()=>{let t=document.querySelector(".custom-prompt-modal");t&&(t.classList.remove("active"),setTimeout(()=>{document.body.removeChild(t),document.body.style.overflow="auto",window.passwordChangeCallback&&(window.passwordChangeCallback(null,null),window.passwordChangeCallback=null)},300))},a=()=>{let t=document.getElementById("oldPasswordInput"),e=document.getElementById("newPasswordInput"),s=t?t.value.trim():"",o=e?e.value.trim():"",n=document.querySelector(".custom-prompt-modal");n&&(n.classList.remove("active"),setTimeout(()=>{document.body.removeChild(n),document.body.style.overflow="auto",window.passwordChangeCallback&&(window.passwordChangeCallback(s,o),window.passwordChangeCallback=null)},300))}},5445:(t,e,s)=>{"use strict";s.r(e),s.d(e,{closeCustomAlert:()=>n,safeAlert:()=>a,showCustomAlert:()=>o});let o=(t,e)=>{let s=document.createElement("div");s.className="custom-alert-modal",s.innerHTML='\n        <div class="custom-alert-content">\n            <div class="custom-alert-message">'.concat(t,'</div>\n            <button class="custom-alert-btn" onclick="closeCustomAlert()">確定</button>\n        </div>\n    '),document.body.appendChild(s),window.customAlertCallback=e,document.body.style.overflow="hidden",setTimeout(()=>{s.classList.add("active")},10)},n=()=>{let t=document.querySelector(".custom-alert-modal");t&&(t.classList.remove("active"),setTimeout(()=>{document.body.removeChild(t),document.body.style.overflow="auto",window.customAlertCallback&&(window.customAlertCallback(),window.customAlertCallback=null)},300))},a=(t,e)=>{o(t,e)}},5731:(t,e,s)=>{"use strict";s.d(e,{Py:()=>a});var o=s(3464);let n=s(9509).env.NEXT_PUBLIC_API_ORIGIN||"/api",a="".concat(n),i=o.A.create({baseURL:a,withCredentials:!0}),l=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.startsWith("/")?"".concat(a).concat(t):"".concat(a,"/").concat(t),o=await fetch(s,{...e,credentials:"include"});if(!o.ok)throw Error("API Error: ".concat(o.status));return o.json()};try{l[Symbol.toPrimitive]=()=>a,l.toString=()=>a,l.valueOf=()=>a}catch(t){}try{i[Symbol.toPrimitive]=()=>a,i.toString=()=>a,i.valueOf=()=>a}catch(t){}},6153:(t,e,s)=>{"use strict";s.d(e,{A:()=>l});var o=s(5155),n=s(6874),a=s.n(n),i=s(6766);function l(t){let{showMenu:e=!1,isMenuOpen:s=!1,onToggleMenu:n=null,showAuthNav:l=!1,enableNoteQLink:c=!1}=t;return(0,o.jsx)("section",{id:"header",children:(0,o.jsx)("header",{className:"site-header",children:(0,o.jsxs)("div",{className:"container header-container",children:[c?(0,o.jsx)(a(),{href:"/homegame",className:"brand-name",style:{textDecoration:"none",color:"inherit"},children:"NoteQ"}):(0,o.jsx)("div",{className:"brand-name",children:"NoteQ"}),l&&(0,o.jsxs)("nav",{className:"auth-nav",children:[(0,o.jsx)(a(),{href:"/login?signup=1",className:"btn-signup",children:"Sign up"}),(0,o.jsx)(a(),{href:"/login",className:"btn-login",children:"Login"})]}),e&&(0,o.jsx)("button",{className:"menu-button ".concat(s?"active":""),"aria-label":"Toggle menu",onClick:n,children:(0,o.jsx)(i.default,{src:"/img/Vector-18.png",alt:"Menu Icon",width:24,height:24})})]})})})}},6735:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>m});var o=s(5155),n=s(5731),a=s(2115),i=s(5695),l=s(6766),c=s(6153),r=s(548),d=s.n(r),u=s(9057);function m(){let t=(0,i.useRouter)(),[e,s]=(0,a.useState)(!1),[r,m]=(0,a.useState)(!1),[h,p]=(0,a.useState)(""),[w,f]=(0,a.useState)(""),[C,g]=(0,a.useState)(!1),v=async e=>{if(e.preventDefault(),!h.trim()||!w.trim())return void(0,u.S5)("請填寫所有欄位");if(h!==w)return void(0,u.S5)("兩次輸入的密碼不一致");if(h.length<6)return void(0,u.S5)("密碼長度至少需要6個字符");g(!0);let s=new URLSearchParams(window.location.search).get("uid");try{let e=await fetch("".concat(n.Py,"/reset-password-from-email/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:s,new_password:w})});if(!e.ok)throw Error("重設失敗");await e.json(),(0,u.S5)("密碼重設成功，請使用新密碼登入"),t.push("/login")}catch(t){(0,u.S5)("重設失敗，請稍後再試")}finally{g(!1)}};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c.A,{showAuthNav:!0}),(0,o.jsx)("main",{className:d().authMain,children:(0,o.jsx)("div",{className:d().authContainer,children:(0,o.jsxs)("div",{className:d().formSection,children:[(0,o.jsx)("h1",{className:d().authTitle,children:"重設密碼"}),(0,o.jsxs)("form",{className:d().authForm,onSubmit:v,children:[(0,o.jsxs)("div",{className:d().inputGroup,children:[(0,o.jsxs)("div",{className:d().inputHeader,children:[(0,o.jsx)("div",{className:d().inputIcon,children:(0,o.jsx)(l.default,{src:"/img/Vector-7.png",alt:"Password icon",className:d().icon,width:24,height:24})}),(0,o.jsx)("label",{className:d().inputLabel,children:"新密碼"})]}),(0,o.jsxs)("div",{className:d().passwordInputContainer,children:[(0,o.jsx)("input",{type:e?"text":"password",className:d().inputField,required:!0,value:h,onChange:t=>p(t.target.value),placeholder:"請輸入新密碼"}),(0,o.jsxs)("button",{type:"button",className:d().passwordToggle,onClick:()=>{s(!e)},children:[(0,o.jsx)(l.default,{src:"/img/Vector-39.png",alt:"Show password",className:"".concat(d().icon," ").concat(e?d().hidden:""),width:20,height:20}),(0,o.jsx)(l.default,{src:"/img/Vector-38.png",alt:"Hide password",className:"".concat(d().icon," ").concat(e?"":d().hidden),width:20,height:20})]})]}),(0,o.jsx)("div",{className:d().inputUnderline})]}),(0,o.jsxs)("div",{className:d().inputGroup,children:[(0,o.jsxs)("div",{className:d().inputHeader,children:[(0,o.jsx)("div",{className:d().inputIcon,children:(0,o.jsx)(l.default,{src:"/img/Vector-7.png",alt:"Confirm password icon",className:d().icon,width:24,height:24})}),(0,o.jsx)("label",{className:d().inputLabel,children:"確認密碼"})]}),(0,o.jsxs)("div",{className:d().passwordInputContainer,children:[(0,o.jsx)("input",{type:r?"text":"password",className:d().inputField,required:!0,value:w,onChange:t=>f(t.target.value),placeholder:"請再次輸入新密碼"}),(0,o.jsxs)("button",{type:"button",className:d().passwordToggle,onClick:()=>{m(!r)},children:[(0,o.jsx)(l.default,{src:"/img/Vector-39.png",alt:"Show password",className:"".concat(d().icon," ").concat(r?d().hidden:""),width:20,height:20}),(0,o.jsx)(l.default,{src:"/img/Vector-38.png",alt:"Hide password",className:"".concat(d().icon," ").concat(r?"":d().hidden),width:20,height:20})]})]}),(0,o.jsx)("div",{className:d().inputUnderline})]}),(0,o.jsx)("button",{type:"submit",className:d().authButton,disabled:C,children:C?"重設中...":"重設密碼"})]}),(0,o.jsx)("div",{className:d().switchLink,children:(0,o.jsx)("a",{href:"#",className:d().linkText,onClick:()=>{t.push("/login")},children:"返回登入頁面"})})]})})})]})}},9057:(t,e,s)=>{"use strict";s.d(e,{S5:()=>o.safeAlert,gB:()=>n.safeConfirm,bF:()=>a.showPasswordChangeDialog});var o=s(5445),n=s(4247),a=s(4740);Promise.resolve().then(s.bind(s,5445)).then(t=>{window.showCustomAlert=t.showCustomAlert,window.closeCustomAlert=t.closeCustomAlert,window.safeAlert=t.safeAlert}),Promise.resolve().then(s.bind(s,4247)).then(t=>{window.showCustomConfirm=t.showCustomConfirm,window.closeCustomConfirm=t.closeCustomConfirm,window.safeConfirm=t.safeConfirm}),s.e(11).then(s.bind(s,11)).then(t=>{window.showCustomPrompt=t.showCustomPrompt,window.closeCustomPrompt=t.closeCustomPrompt,window.confirmCustomPrompt=t.confirmCustomPrompt}),Promise.resolve().then(s.bind(s,4740)).then(t=>{window.showPasswordChangeDialog=t.showPasswordChangeDialog,window.closePasswordChangeDialog=t.closePasswordChangeDialog,window.confirmPasswordChange=t.confirmPasswordChange})}},t=>{t.O(0,[435,794,259,441,964,358],()=>t(t.s=1211)),_N_E=t.O()}]);